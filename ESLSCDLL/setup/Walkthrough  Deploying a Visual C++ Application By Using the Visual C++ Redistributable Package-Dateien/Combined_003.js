(function(){function getParameterByName(name,url){url||(url=window.location.href);name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null}function showMessage(seconds){document.getElementById("redirectInfo").innerHTML=document.getElementById("redirectInfo").innerHTML.replace(/\d+/,seconds)}function showError(error){document.getElementById("redirectInfo").innerHTML=error}function parseUrl(url){var r={},a=document.createElement("a");return a.href=url,["protocol","hostname","port","pathname","search","hash"].map(function(n){r[n]=a[n]}),r}function strEndsWith(str,suffix){return str.match(suffix+"$")==suffix}function isValidUrl(url,hostWhiteList){for(var urlParts=parseUrl(url),i=0;i<hostWhiteList.length;i++)if(urlParts.hostname.toLowerCase()===hostWhiteList[i]||strEndsWith(urlParts.hostname.toLowerCase(),"."+hostWhiteList[i]))return!0;return!1}window.onload=function(){var hostWhiteList,redirectUrl,remainingSeconds;document.getElementById("redirectInfo")!==null&&(hostWhiteList=["microsoft.com","visualstudio.com","github.com"],redirectUrl=getParameterByName("redirectUrl",window.location.href),redirectUrl&&redirectUrl.length>0&&(isValidUrl(redirectUrl,hostWhiteList)?(document.getElementById("redirectInfo").innerHTML=document.getElementById("jumpInfo").innerHTML,remainingSeconds=1,showMessage(remainingSeconds),setInterval(function(){remainingSeconds>0?(remainingSeconds--,showMessage(remainingSeconds)):remainingSeconds===0&&(remainingSeconds--,window.location.href=redirectUrl)},1e3)):showError("XSS and Open Redirect Vulnerability Error!")))}})();;
window.vscins=window.vscins||{};window.vscins.addtag=function(){$("header").attr("ms.pgarea","header");$(".navL1").attr("ms.cmpgrp","main nav")};$(document).ready(function(){window.vscins.addtag()});;
epx=window.epx||{};epx.library=window.epx.library||{};epx.library.toc=function(){function init(){initLocalizeString();var $sections=$("div#tocnav > div[class^='toc']"),$childrenSection=$(nodePaddingFormat);$("#tocnav div[data-toclevel]").each(function(){initNode($(this),$sections,$childrenSection)});hideTooManyFirstLevelSiblings($sections[0]);updateIfHighContrastMode();updateAriaLabel();$("#isd_archiveControlResponsive").click(function(){var control=$("#isd_archiveControlResponsive");control.text()!=""&&($("#tocnav").hasClass("hide-archive")?(control.html("<ins/>"+control.attr("data-exclude-archive")),control.attr("aria-label",control.attr("data-exclude-archive"))):(control.html("<ins/>"+control.attr("data-include-archive")),control.attr("aria-label",control.attr("data-include-archive"))),$("#tocnav, #content.bumper").toggleClass("hide-archive"),typeof define=="function"&&typeof require=="function"&&window.mtpsAmd?require("tocFixed").setPosition():window.epx.library.tocFixed&&typeof window.epx.library.tocFixed.setPosition=="function"&&window.epx.library.tocFixed.setPosition())});$("#tocExpandButton").click(function(e){return expandTocSiblingsClick(),e.stopPropagation(),!1});$("#tocnav div.archive:first").length>0&&$("#tocnav div.archive.current").length==0&&($("#tocnav").append($("#isd_archiveControlResponsive").parent()),$("#isd_archiveControlResponsive").show(),$("#isd_archiveControlResponsive").html("<ins/>"+$("#isd_archiveControlResponsive").attr("data-exclude-archive")));addArchiveIcon($("#tocnav"));$("#tocnav").on("click","a.toc_collapsed",function(){function addNodesIn($div,$parentDiv,nodes,startIndex,endIndex){for(var parentExpandingLevel=getLevel($div),parentArchive=$div.hasClass("archive"),$node,i=startIndex;i<=endIndex;i++){var nodeHasChildren=!1,childCountId=null,isArchived=!1;nodes[i].Href&&(nodes[i].ExtendedAttributes&&(nodes[i].ExtendedAttributes[hasSubTreeAttr]&&(nodeHasChildren=nodes[i].ExtendedAttributes[hasSubTreeAttr]==="true"),nodes[i].ExtendedAttributes["data-childCountId"]&&(childCountId=nodes[i].ExtendedAttributes["data-childCountId"],window.MTPS&&window.MTPS.TopicNodes&&(window.MTPS.TopicNodes[childCountId]=nodes[i].ExtendedAttributes["data-childCount"])),$.type(nodes[i].ExtendedAttributes["data-isarchived"])=="string"&&(isArchived=nodes[i].ExtendedAttributes["data-isarchived"].toLowerCase()=="true")),$node=$(buildNode(nodes[i].Href,nodes[i].Title,parentExpandingLevel+1,!1,nodeHasChildren,childCountId)),(isArchived||parentArchive)&&$node.addClass("archive"),nodes[i].Href===currentHref&&$node.addClass("current"),$node.appendTo($parentDiv),addArchiveIcon($parentDiv))}updateIfHighContrastMode();updateAriaLabel($parentDiv);updatePosition()}var $chevron=$(this),$div=$chevron.parent(),level=getLevel($div),$nextTocPaddingDiv,href,toolBarStatus,useCache;return $div.attr(childrenLoadedAttr)==="true"?(window.epx.utilities.log("Child nodes already loaded"),$chevron.attr("class","toc_expanded"),updateAriaLabel($chevron),$nextTocPaddingDiv=$div.next(),!$nextTocPaddingDiv.hasClass("tocPadding"))?!1:($nextTocPaddingDiv.removeClass("hidden"),epx.library.tocFixed!=undefined&&epx.library.tocFixed!=null&&epx.library.tocFixed.setPosition(),!1):(window.epx.utilities.log("Loading TOC nodes"),href=buildTocHref($chevron.siblings().first().attr("href")),href==undefined||href==null)?!1:(toolBarStatus=window.epx.utilities.getCookie("ShowPrintToolBar",""),useCache=!(toolBarStatus==="true"),$.ajax({type:"GET",async:!0,url:href,cache:useCache,dataType:"json",success:function(r){if(!r||r.length<1){window.epx.utilities.log("TOC web service returned 0 nodes.");return}if(window.epx.utilities.log("TOC web service returned "+r.length+" node(s), processing..."),$newPadding=$(nodePaddingFormat),addNodesIn($div,$newPadding,r,0,r.length-1),$div.after($newPadding),window.MTPS&&window.MTPS.Export&&window.MTPS.Export.initViaLink&&window.MTPS.Export.initViaLink($newPadding.find("a")),$("#tocnav>div.current.archive").length!=1){var firstArchiveNode=$("#tocnav>div.archive:first");firstArchiveNode.length>0&&($("#tocnav.hidearchive").length>0?($("#isd_archiveControlResponsive").show(),$("#isd_archiveControlResponsive").text($("#isd_archiveControl").attr("data-exclude-archive"))):($("#isd_archiveControlResponsive").show(),$("#isd_archiveControlResponsive").text($("#isd_archiveControlResponsive").attr("data-include-archive"))));updatePosition()}}}),$div.attr(childrenLoadedAttr,"true"),$chevron.attr("class","toc_expanded"),updateAriaLabel($chevron),appInsightLog("TocExpandCount",{tocHref:href}),!1)});$("#tocnav").on("click","a.toc_expanded",function(){return expandClick($(this))});$("#tocnav").on("click",'a[href^="/"]',subscribeTocLinkClick);$("#exportDisclaimer").length>0&&$("#tocMenuToggler").hide();$("#tocMenuToggler").click(function(e){$("#leftNav").parent().hasClass("bodyTocMenuCollapsed")==!1?hideToc():showToc();updatePosition();e.stopPropagation()})}function updatePosition(){epx.library.tocFixed!=undefined&&epx.library.tocFixed!=null&&epx.library.tocFixed.setPosition()}function initNode($div,$sections,$childrenSection){var $link=$div.children().last(),level=getLevel($div),current=isCurrent($div),children=hasChildren($div),expanded=children&&current,chevron;if(expanded===!0&&$div.attr(childrenLoadedAttr,"true"),current===!0&&(currentHref=$div.children("a").last().attr("href"),insertedIndex++),chevron=buildChevron(expanded,children),$link.before(chevron),current===!0&&children===!1&&updateParentChevronForLeafNode($div,level),insertedIndex==1&&!current&&level<=1&&insertedIndex++,insertedIndex>1)return!1;insertedIndex==1&&!current&&level>1?$div.appendTo($childrenSection):$div.appendTo($sections[insertedIndex]);current===!0&&$childrenSection.appendTo($sections[insertedIndex])}function hideTooManyFirstLevelSiblings(div){if($siblings=$(div).find("div[data-toclevel]"),$siblings.size()>3){$hideArea=$(div).find("div#tocExpand")[0];$expandArea=$(div).find("div#tocExpandArea")[0];for(var i=0;i<$siblings.size()-3;i++)$($siblings[i]).appendTo($hideArea);$($expandArea).show()}}function initLocalizeString(){expandNodeTooltip=$("#ExpandLocalizeString").text().trim();collapseNodeTooltip=$("#CollapseLocalizeString").text().trim()}function updateParentChevronForLeafNode($div,level){var $parent=$div.parent().children("div["+levelAttr+'="'+(level-1)+'"]').last(),parentChevron=buildChevron(!0,!0);$parent.children().length>0&&($parent.children().first().replaceWith(parentChevron),$parent.attr(childrenLoadedAttr,"true"))}function updateIfHighContrastMode(){function updateForHighContrastMode($element,html){$element.html(html).css({width:"auto",height:"auto","margin-top":"0px"})}var $firstChevron=$("a.toc_expanded:first"),$banner;if($firstChevron){switch($firstChevron.css("background-image")){case"":case"none":break;default:return}$("a.toc_expanded").each(function(){updateForHighContrastMode($(this),"-")});$("a.toc_collapsed").each(function(){updateForHighContrastMode($(this),"+")});$banner=$("#tn_header > div.upperBand > a:first");$banner&&$banner.html($banner.attr("title"))}}function expandClick($chevron){var $div=$chevron.parent(),expandingLevel=getLevel($div),$nextTocPaddingDiv;return($chevron.attr("class","toc_collapsed"),updateAriaLabel($chevron),$nextTocPaddingDiv=$div.next(),!$nextTocPaddingDiv.hasClass("tocPadding"))?!1:($nextTocPaddingDiv.addClass("hidden"),appInsightLog("TocCollapseCount",{tocHref:$chevron.siblings().first().attr("href")}),!1)}function expandTocSiblingsClick(){$("div#tocExpandArea").hide();$("div#tocExpand").show()}function buildTocHref(baseHref){return baseHref==undefined||baseHref==null?null:baseHref.indexOf("?")===-1?baseHref+"?toc=1":baseHref+"&toc=1"}function buildChevron(expanded,children){var cssClass="toc_empty";return children===!0?(cssClass=expanded===!0?"toc_expanded":"toc_collapsed",chevronFormat.replace("{class}",cssClass)):emptyFormat.replace("{class}",cssClass)}function buildNode(href,title,level,expanded,children,childCountId){var isHrefEmpty=href==null,chevron=buildChevron(expanded,isHrefEmpty?!1:children),nodeTagString;return isHrefEmpty?nodeTagString=nodeSpanTagFormat:(nodeTagString=nodeATagFormat.replace("{href}",href),nodeTagString=nodeTagString.replace("{childCountIdAttribute}",childCountId!=null?'id="'+childCountId+'" ':"")),nodeFormat.replace("{level}",level).replace("{chevron}",chevron).replace("{nodeTag}",nodeTagString.replace(/{text}/gi,window.epx.utilities.htmlEncode(title)))}function getChevron($div){return $div.children().first()}function getLevel($div){return parseInt($div.attr(levelAttr))}function isCurrent($div){return $div.hasClass("current")}function hasChildren($div){return getChevron($div).attr(hasSubTreeAttr)==="true"}function subscribeTocLinkClick(){var href=$(this).attr("href");return appInsightLog("TocLinkClickCount",{tocHref:href}),setTimeout(function(){location.href=href},300),!1}function updateAriaLabel(object){object==null?($("a.toc_expanded").each(function(){updateAriaLabel($(this))}),$("a.toc_collapsed").each(function(){updateAriaLabel($(this))})):object.is("a")?(object.hasClass("toc_collapsed")&&object.attr("aria-label",expandNodeTooltip).attr("aria-expanded","false"),object.hasClass("toc_expanded")&&object.attr("aria-label",collapseNodeTooltip).attr("aria-expanded","true")):(object.find("a.toc_expanded").each(function(){updateAriaLabel($(this))}),object.find("a.toc_collapsed").each(function(){updateAriaLabel($(this))}))}function appInsightLog(eventName,eventValue){}function addArchiveIcon($target){$nodes=$target.find("div.archive");$nodes.length>0&&($archiveInfo="The document is archived and information here might be outdated",$("div#isd_archiveInstrument").length>0&&($archiveInfo=$("div#isd_archiveInstrument").text()),$insertArchiveIcon=$("<a role='img' href='javascript:void(0)' title='"+$archiveInfo+"'><\/a>"),$nodes.each(function(){$clone=$insertArchiveIcon.clone();$(this).append($clone);$clone.click(function(e){return!1})}))}function hideToc(){$("#tocMenuTogglerIcon").attr("aria-expanded","false");$("#tocMenuTogglerIcon").attr("class","tocMenuExpanded");$("#tocnav .tocselected, #tocnav .tocunselected").css("min-width",$("#tocnav .tocselected").width());$("#leftNav").parent().addClass("bodyTocMenuCollapsed")}function showToc(){$("#tocMenuTogglerIcon").attr("aria-expanded","true");$("#tocMenuTogglerIcon").attr("class","tocMenuCollapse");$("#leftNav").parent().removeClass("bodyTocMenuCollapsed")}var levelAttr="data-toclevel",childrenLoadedAttr="data-childrenloaded",hasSubTreeAttr="data-tochassubtree",chevronFormat='<a class="{class}" href="javascript:void(0)" role="button" />',emptyFormat='<span class="{class}" />',nodeFormat='<div class="toclevel" '+levelAttr+'="{level}">{chevron}{nodeTag}<\/div>',nodeATagFormat='<a {childCountIdAttribute}href="{href}" title="{text}">{text}<\/a>',nodeSpanTagFormat='<span class="emptyHref">{text}<\/span>',nodePaddingFormat='<div class="tocPadding"><\/div>',insertedIndex=0,currentHref="",expandNodeTooltip="",collapseNodeTooltip="";return{init:init,initNode:initNode,expandClick:expandClick,buildTocHref:buildTocHref,buildChevron:buildChevron,buildNode:buildNode,getChevron:getChevron,getLevel:getLevel,isCurrent:isCurrent,hasChildren:hasChildren}}();$(document).ready(function(){epx.library.toc.init()});;
